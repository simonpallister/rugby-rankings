{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/simonpallister/Code/rugby-rankings-2/app/api/fixtures/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\n\nexport async function GET(request: Request) {\n  try {\n    const { searchParams } = new URL(request.url);\n    const startDate = searchParams.get(\"startDate\") || getOneMonthAgo();\n    const endDate = searchParams.get(\"endDate\") || getSixMonthsLater();\n\n    const allMatches = [];\n    let page = 0;\n    let hasMore = true;\n\n    // Fetch all pages of fixtures\n    while (hasMore) {\n      const url = `https://api.wr-rims-prod.pulselive.com/rugby/v3/match?startDate=${startDate}&endDate=${endDate}&sort=asc&pageSize=100&page=${page}`;\n\n      const response = await fetch(url, {\n        headers: {\n          Accept: \"application/json\",\n        },\n        next: { revalidate: 3600 }, // Cache for 1 hour\n      });\n\n      if (!response.ok) {\n        throw new Error(\"Failed to fetch fixtures\");\n      }\n\n      const data = await response.json();\n      const matches = data.content || [];\n\n      allMatches.push(...matches);\n\n      // If we got less than 100 results, we've reached the last page\n      hasMore = matches.length === 100;\n      page++;\n    }\n\n    return NextResponse.json({ content: allMatches });\n  } catch (error) {\n    console.error(\"Error fetching fixtures:\", error);\n    return NextResponse.json(\n      { error: \"Failed to fetch fixtures\" },\n      { status: 500 }\n    );\n  }\n}\n\nfunction getOneMonthAgo(): string {\n  const date = new Date();\n  date.setMonth(date.getMonth() - 1);\n  return date.toISOString().split(\"T\")[0];\n}\n\nfunction getSixMonthsLater(): string {\n  const date = new Date();\n  date.setMonth(date.getMonth() + 6);\n  return date.toISOString().split(\"T\")[0];\n}\n"],"names":[],"mappings":";;;;AAAA;;AAEO,eAAe,IAAI,OAAgB;IACxC,IAAI;QACF,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,QAAQ,GAAG;QAC5C,MAAM,YAAY,aAAa,GAAG,CAAC,gBAAgB;QACnD,MAAM,UAAU,aAAa,GAAG,CAAC,cAAc;QAE/C,MAAM,aAAa,EAAE;QACrB,IAAI,OAAO;QACX,IAAI,UAAU;QAEd,8BAA8B;QAC9B,MAAO,QAAS;YACd,MAAM,MAAM,CAAC,gEAAgE,EAAE,UAAU,SAAS,EAAE,QAAQ,4BAA4B,EAAE,MAAM;YAEhJ,MAAM,WAAW,MAAM,MAAM,KAAK;gBAChC,SAAS;oBACP,QAAQ;gBACV;gBACA,MAAM;oBAAE,YAAY;gBAAK;YAC3B;YAEA,IAAI,CAAC,SAAS,EAAE,EAAE;gBAChB,MAAM,IAAI,MAAM;YAClB;YAEA,MAAM,OAAO,MAAM,SAAS,IAAI;YAChC,MAAM,UAAU,KAAK,OAAO,IAAI,EAAE;YAElC,WAAW,IAAI,IAAI;YAEnB,+DAA+D;YAC/D,UAAU,QAAQ,MAAM,KAAK;YAC7B;QACF;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAW;IACjD,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,4BAA4B;QAC1C,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAA2B,GACpC;YAAE,QAAQ;QAAI;IAElB;AACF;AAEA,SAAS;IACP,MAAM,OAAO,IAAI;IACjB,KAAK,QAAQ,CAAC,KAAK,QAAQ,KAAK;IAChC,OAAO,KAAK,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE;AACzC;AAEA,SAAS;IACP,MAAM,OAAO,IAAI;IACjB,KAAK,QAAQ,CAAC,KAAK,QAAQ,KAAK;IAChC,OAAO,KAAK,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE;AACzC"}}]
}