{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 14, "column": 0}, "map": {"version":3,"sources":["file:///Users/simonpallister/Code/rugby-rankings-2/components/RankingsCalculator.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/components/RankingsCalculator.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/RankingsCalculator.tsx <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;uCACe,IAAA,wQAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAAqS,GAClU,mEACA","ignoreList":[0]}},
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///Users/simonpallister/Code/rugby-rankings-2/components/RankingsCalculator.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/components/RankingsCalculator.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/RankingsCalculator.tsx\",\n    \"default\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;uCACe,IAAA,wQAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAAiR,GAC9S,+CACA","ignoreList":[0]}},
    {"offset": {"line": 42, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 50, "column": 0}, "map": {"version":3,"sources":["file:///Users/simonpallister/Code/rugby-rankings-2/lib/api.ts"],"sourcesContent":["import { Ranking, Fixture, Team } from \"@/types\";\n\nexport interface WRRankingEntry {\n  team: {\n    id: number;\n    name: string;\n    abbreviation: string;\n  };\n  pts: number;\n  pos: number;\n  previousPts: number;\n  previousPos: number;\n}\n\nexport interface WRRankingsResponse {\n  entries: WRRankingEntry[];\n  label: string;\n  effectiveTime: string;\n}\n\nexport interface WRMatch {\n  matchId?: string;\n  id?: number;\n  time: {\n    label: string;\n    millis: number;\n  };\n  teams: Array<{\n    id: number;\n    name: string;\n    abbreviation: string;\n    score?: number;\n  }>;\n  status: string;\n  venue?: {\n    name: string;\n    city: string;\n    country: string;\n  };\n  events?: Array<{\n    id: number;\n    label: string;\n    rankingsWeight: number;\n  }>;\n}\n\nexport interface WRFixturesResponse {\n  content: WRMatch[];\n}\n\n/**\n * Transform World Rugby rankings API response to internal format\n */\nexport function transformRankings(data: WRRankingsResponse): Ranking[] {\n  return data.entries.map((entry) => ({\n    team: {\n      id: entry.team.id.toString(),\n      name: entry.team.name,\n      abbreviation: entry.team.abbreviation,\n    },\n    pts: entry.pts,\n    pos: entry.pos,\n    previousPts: entry.previousPts,\n    previousPos: entry.previousPos,\n  }));\n}\n\n/**\n * Transform World Rugby fixtures API response to internal format\n */\nexport function transformFixtures(\n  data: WRFixturesResponse,\n  rankingsTime: number,\n  rankedTeamIds: Set<string>\n): Fixture[] {\n  return data.content\n    .filter((match) => {\n      // Only include future matches or matches that happened after the rankings date\n      return (\n        match.status !== \"C\" || match.time.millis > rankingsTime\n      );\n    })\n    .filter((match) => {\n      // Only include matches with two teams\n      return match.teams.length === 2;\n    })\n    .filter((match) => {\n      // Only include matches where both teams are in the rankings (international test matches)\n      const team1Id = match.teams[0].id.toString();\n      const team2Id = match.teams[1].id.toString();\n      return rankedTeamIds.has(team1Id) && rankedTeamIds.has(team2Id);\n    })\n    .map((match) => {\n      const homeTeam: Team = {\n        id: match.teams[0].id.toString(),\n        name: match.teams[0].name,\n        abbreviation: match.teams[0].abbreviation,\n      };\n\n      const awayTeam: Team = {\n        id: match.teams[1].id.toString(),\n        name: match.teams[1].name,\n        abbreviation: match.teams[1].abbreviation,\n      };\n\n      const isRwc = match.events?.some((e) => e.rankingsWeight === 2) || false;\n\n      return {\n        id: match.matchId || match.id?.toString() || `${match.time.millis}`,\n        homeTeam,\n        awayTeam,\n        homeScore: match.teams[0].score ?? null,\n        awayScore: match.teams[1].score ?? null,\n        isRwc,\n        noHome: false, // This would need venue detection logic\n        date: new Date(match.time.millis).toISOString(),\n      };\n    });\n}\n\n/**\n * Fetch rankings from World Rugby API (server-side)\n */\nexport async function fetchRankings(): Promise<{\n  rankings: Ranking[];\n  effectiveTime: string;\n}> {\n  const response = await fetch(\n    \"https://api.wr-rims-prod.pulselive.com/rugby/v3/rankings/mru?language=en&client=pulse\",\n    {\n      headers: {\n        Accept: \"application/json\",\n      },\n      next: { revalidate: 3600 }, // Cache for 1 hour\n    }\n  );\n\n  if (!response.ok) {\n    throw new Error(\"Failed to fetch rankings\");\n  }\n\n  const data: WRRankingsResponse = await response.json();\n  return {\n    rankings: transformRankings(data),\n    effectiveTime: data.effectiveTime,\n  };\n}\n\n/**\n * Fetch fixtures from World Rugby API (server-side)\n */\nexport async function fetchFixtures(\n  startDate: string,\n  endDate: string\n): Promise<WRMatch[]> {\n  const allMatches: WRMatch[] = [];\n  let page = 0;\n  let hasMore = true;\n\n  // Fetch all pages of fixtures\n  while (hasMore) {\n    const url = `https://api.wr-rims-prod.pulselive.com/rugby/v3/match?startDate=${startDate}&endDate=${endDate}&sort=asc&pageSize=100&page=${page}`;\n\n    const response = await fetch(url, {\n      headers: {\n        Accept: \"application/json\",\n      },\n      next: { revalidate: 3600 }, // Cache for 1 hour\n    });\n\n    if (!response.ok) {\n      throw new Error(\"Failed to fetch fixtures\");\n    }\n\n    const data = await response.json();\n    const matches = data.content || [];\n\n    allMatches.push(...matches);\n\n    // If we got less than 100 results, we've reached the last page\n    hasMore = matches.length === 100;\n    page++;\n  }\n\n  return allMatches;\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 158, "column": 0}, "map": {"version":3,"sources":["file:///Users/simonpallister/Code/rugby-rankings-2/app/page.tsx"],"sourcesContent":["import RankingsCalculator from \"@/components/RankingsCalculator\";\nimport { fetchRankings, fetchFixtures, transformFixtures } from \"@/lib/api\";\n\nexport default async function Home() {\n  // Fetch data server-side\n  const { rankings, effectiveTime } = await fetchRankings();\n  const rankingsTime = new Date(effectiveTime).getTime();\n\n  // Calculate date range (1 month ago to 6 months ahead)\n  const now = Date.now();\n  const oneMonthAgo = new Date(now - 30 * 24 * 60 * 60 * 1000);\n  const sixMonthsLater = new Date(now + 180 * 24 * 60 * 60 * 1000);\n\n  const startDate = oneMonthAgo.toISOString().split(\"T\")[0];\n  const endDate = sixMonthsLater.toISOString().split(\"T\")[0];\n\n  // Fetch fixtures\n  const fixturesData = await fetchFixtures(startDate, endDate);\n\n  // Get ranked team IDs for filtering\n  const rankedTeamIds = new Set(rankings.map((r) => r.team.id));\n\n  // Transform and filter fixtures\n  const allFixtures = transformFixtures(\n    { content: fixturesData },\n    rankingsTime,\n    rankedTeamIds\n  );\n\n  // Split into completed and upcoming\n  const oneWeekFromNow = now + 7 * 24 * 60 * 60 * 1000;\n\n  const completedFixtures = allFixtures.filter(\n    (f) => f.homeScore !== null && f.awayScore !== null\n  );\n\n  const upcomingFixtures = allFixtures.filter(\n    (f) =>\n      (f.homeScore === null || f.awayScore === null) &&\n      new Date(f.date || 0).getTime() >= now &&\n      new Date(f.date || 0).getTime() <= oneWeekFromNow\n  );\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-gray-50 via-green-50 to-gray-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900\">\n      {/* Header */}\n      <header className=\"bg-white dark:bg-gray-800 shadow-md border-b-4 border-green-600\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6\">\n          <h1 className=\"text-4xl font-bold text-gray-900 dark:text-white\">\n            World Rugby Rankings Calculator\n          </h1>\n          <p className=\"mt-2 text-gray-600 dark:text-gray-400\">\n            Calculate how match results affect World Rugby rankings\n          </p>\n        </div>\n      </header>\n\n      <main className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n        <RankingsCalculator\n          initialRankings={rankings}\n          completedFixtures={completedFixtures}\n          upcomingFixtures={upcomingFixtures}\n        />\n\n        {/* Footer */}\n        <footer className=\"mt-12 text-center text-sm text-gray-500 dark:text-gray-400\">\n          <p>\n            Rankings calculation based on{\" \"}\n            <a\n              href=\"https://www.world.rugby/tournaments/rankings/explanation\"\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n              className=\"text-green-600 dark:text-green-400 hover:underline\"\n            >\n              World Rugby methodology\n            </a>\n          </p>\n          <p className=\"mt-2\">\n            Data from{\" \"}\n            <a\n              href=\"https://www.world.rugby/rankings\"\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n              className=\"text-green-600 dark:text-green-400 hover:underline\"\n            >\n              World Rugby\n            </a>\n            {\" â€¢ \"}\n            Inspired by{\" \"}\n            <a\n              href=\"https://rawling.github.io/wr-calc/\"\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n              className=\"text-green-600 dark:text-green-400 hover:underline\"\n            >\n              rawling/wr-calc\n            </a>\n          </p>\n        </footer>\n      </main>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAAA;AACA;;;;AAEe,eAAe;IAC5B,yBAAyB;IACzB,MAAM,EAAE,QAAQ,EAAE,aAAa,EAAE,GAAG,MAAM,IAAA,2HAAa;IACvD,MAAM,eAAe,IAAI,KAAK,eAAe,OAAO;IAEpD,uDAAuD;IACvD,MAAM,MAAM,KAAK,GAAG;IACpB,MAAM,cAAc,IAAI,KAAK,MAAM,KAAK,KAAK,KAAK,KAAK;IACvD,MAAM,iBAAiB,IAAI,KAAK,MAAM,MAAM,KAAK,KAAK,KAAK;IAE3D,MAAM,YAAY,YAAY,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE;IACzD,MAAM,UAAU,eAAe,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE;IAE1D,iBAAiB;IACjB,MAAM,eAAe,MAAM,IAAA,2HAAa,EAAC,WAAW;IAEpD,oCAAoC;IACpC,MAAM,gBAAgB,IAAI,IAAI,SAAS,GAAG,CAAC,CAAC,IAAM,EAAE,IAAI,CAAC,EAAE;IAE3D,gCAAgC;IAChC,MAAM,cAAc,IAAA,+HAAiB,EACnC;QAAE,SAAS;IAAa,GACxB,cACA;IAGF,oCAAoC;IACpC,MAAM,iBAAiB,MAAM,IAAI,KAAK,KAAK,KAAK;IAEhD,MAAM,oBAAoB,YAAY,MAAM,CAC1C,CAAC,IAAM,EAAE,SAAS,KAAK,QAAQ,EAAE,SAAS,KAAK;IAGjD,MAAM,mBAAmB,YAAY,MAAM,CACzC,CAAC,IACC,CAAC,EAAE,SAAS,KAAK,QAAQ,EAAE,SAAS,KAAK,IAAI,KAC7C,IAAI,KAAK,EAAE,IAAI,IAAI,GAAG,OAAO,MAAM,OACnC,IAAI,KAAK,EAAE,IAAI,IAAI,GAAG,OAAO,MAAM;IAGvC,qBACE,8OAAC;QAAI,WAAU;;0BAEb,8OAAC;gBAAO,WAAU;0BAChB,cAAA,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAG,WAAU;sCAAmD;;;;;;sCAGjE,8OAAC;4BAAE,WAAU;sCAAwC;;;;;;;;;;;;;;;;;0BAMzD,8OAAC;gBAAK,WAAU;;kCACd,8OAAC,4IAAkB;wBACjB,iBAAiB;wBACjB,mBAAmB;wBACnB,kBAAkB;;;;;;kCAIpB,8OAAC;wBAAO,WAAU;;0CAChB,8OAAC;;oCAAE;oCAC6B;kDAC9B,8OAAC;wCACC,MAAK;wCACL,QAAO;wCACP,KAAI;wCACJ,WAAU;kDACX;;;;;;;;;;;;0CAIH,8OAAC;gCAAE,WAAU;;oCAAO;oCACR;kDACV,8OAAC;wCACC,MAAK;wCACL,QAAO;wCACP,KAAI;wCACJ,WAAU;kDACX;;;;;;oCAGA;oCAAM;oCACK;kDACZ,8OAAC;wCACC,MAAK;wCACL,QAAO;wCACP,KAAI;wCACJ,WAAU;kDACX;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQb"}}]
}